import{a as pe}from"./chunk-5HCIN323.js";import"./chunk-L22KP5OG.js";import"./chunk-UZZJTQF6.js";import"./chunk-R3U4HL6C.js";import"./chunk-64A2DPZG.js";import"./chunk-UGROY5TD.js";import{a as de}from"./chunk-2UWTBI75.js";import{a as le,b as se}from"./chunk-MOIGIHJD.js";import"./chunk-W2XR4WIZ.js";import{a as P}from"./chunk-NY5GKKF2.js";import{a as u}from"./chunk-5DENEAAF.js";import{$a as l,Ab as z,Bb as K,Eb as Q,Fa as E,Fb as U,Ga as N,Ha as B,Ia as V,Ib as X,Ja as r,Ka as o,La as v,M as _,Nb as Y,P as x,Pa as I,Ra as k,S as $,Sa as S,Ub as Z,Z as w,_ as O,_a as R,ab as j,bb as D,c,dc as ee,eb as H,fb as W,gb as G,gc as te,ib as J,kc as ie,lc as ne,mc as oe,na as d,oa as T,ob as m,pb as f,pc as re,qc as ae,sb as q,w as h,xa as p,za as b}from"./chunk-U53D5TZM.js";import"./chunk-YT5AF7SN.js";import"./chunk-SIAVTO45.js";var me=(()=>{let t=class t{constructor(i){this.http=i}getSOE(i){return this.http.get(u.serverAPI.ROOT+u.serverAPI.SOE+i+"/")}getEvent(){return this.http.get(u.serverAPI.ROOT+u.serverAPI.EVENT)}postSOE(i,n){return this.http.post(u.serverAPI.ROOT+u.serverAPI.SOE+i+"/",n)}};t.\u0275fac=function(n){return new(n||t)(x(Y))},t.\u0275prov=_({token:t,factory:t.\u0275fac,providedIn:"root"});let e=t;return e})();var C=new c([]),A=new c(!1),L=new c(!1),Fe=new c(!1),fe=new c([]),M=new c(!1),ue=(()=>{let t=class t{constructor(i){this.httpClient=i,this.Soe$=C.asObservable(),this.SoeLoading$=A.asObservable(),this.Event$=fe.asObservable(),this.EventLoading$=M.asObservable(),this.SoePostLoading$=L.asObservable()}getSoe(i){A.next(!0),this.httpClient.getSOE(i).pipe(h(()=>A.next(!1))).subscribe({next:n=>{C.next(n.sort((s,g)=>new Date(g.created_at).getTime()-new Date(s.created_at).getTime())),console.log(n)},error:n=>{throw console.error("Error on geting SOE list",n.message),new P("Error on geting SOE list")}})}addSoe(i,n){return new Promise((s,g)=>{L.next(!0),this.httpClient.postSOE(i,n).pipe(h(()=>L.next(!1))).subscribe({next:y=>{let F=C.getValue();F.push(y),C.next(F),s(!0)},error:y=>{console.error("Error Posting data",y),g(!1)}})})}getEvent(){M.next(!0),this.httpClient.getEvent().pipe(h(()=>M.next(!1))).subscribe({next:i=>{fe.next(i),console.log(i)},error:i=>{throw console.error("Error on geting SOE Events",i.message),new P("Error on geting SOE Events")}})}};t.\u0275fac=function(n){return new(n||t)(x(me))},t.\u0275prov=_({token:t,factory:t.\u0275fac,providedIn:"root"});let e=t;return e})();function Se(e,t){if(e&1&&(r(0,"option",25),l(1),o()),e&2){let a=t.$implicit;b("value",a.id),d(),D(" ",a.action," ")}}function ge(e,t){if(e&1){let a=I();r(0,"button",26),k("click",function(){w(a);let n=S(2);return O(n.addEvent())}),v(1,"i",27),l(2," Add "),o()}}function Ee(e,t){e&1&&(r(0,"button",28)(1,"span",29),l(2,"Add"),o(),r(3,"span",30),v(4,"i",31),o()())}function he(e,t){if(e&1){let a=I();r(0,"select",22),G("ngModelChange",function(n){w(a);let s=S();return W(s.SelectedEvent,n)||(s.SelectedEvent=n),O(n)}),p(1,Se,2,2,"option",23),o(),p(2,ge,3,0,"button",24),m(3,"async"),p(4,Ee,5,0)}if(e&2){let a=S();H("ngModel",a.SelectedEvent),d(),b("ngForOf",a.Events),d(),E(2,f(3,3,a.data.SoePostLoading$)?4:2)}}function _e(e,t){e&1&&(r(0,"div",32)(1,"span",33),l(2,"Loading..."),o()())}function xe(e,t){e&1&&(r(0,"div",14),l(1," Select an Event. "),o())}function Ce(e,t){e&1&&v(0,"div")}function ye(e,t){e&1&&(r(0,"div",32)(1,"span",33),l(2,"Loading..."),o()())}function we(e,t){if(e&1&&(r(0,"tr",34)(1,"td",35),l(2),m(3,"hoursAgo"),o(),r(4,"td",35),l(5),m(6,"titlecase"),o()()),e&2){let a=t.$implicit;d(2),j(f(3,2,a.created_at)),d(3),j(f(6,4,a.soe_desc))}}function Oe(e,t){if(e&1&&B(0,we,7,6,"tr",34,N),e&2){let a=S(2);V(a.SOEs)}}function Te(e,t){if(e&1&&(r(0,"tbody"),p(1,ye,3,0,"div",32),m(2,"async"),p(3,Oe,2,0),o()),e&2){let a=S();d(),E(1,f(2,1,a.data.SoeLoading$)?1:3)}}function Ie(e,t){e&1&&(r(0,"div",32)(1,"span",33),l(2,"Loading..."),o()())}var Ge=(()=>{let t=class t{constructor(i,n){this.route=i,this.data=n,this.id="",this.SelectedEvent=0,this.Events=[],this.SOEs=[],this.data.getEvent(),this.sub=[],this.id="",this.sub.push(this.data.Event$.subscribe(s=>{this.Events=s,this.Events.length===0||this.SelectedEvent==0&&(this.SelectedEvent=this.Events[0].id)}))}ngOnInit(){this.sub.push(this.route.params.subscribe(i=>{this.id=i.jobNo,this.data.getSoe(this.id)}),this.data.Soe$.subscribe(i=>{this.SOEs=i})),console.log(this.id)}addEvent(){if(console.log(this.SelectedEvent),this.SelectedEvent!=0){let i={action_id:this.SelectedEvent,job_number:this.id};console.log(i),this.data.addSoe(this.id,i)}}};t.\u0275fac=function(n){return new(n||t)(T(Z),T(ue))},t.\u0275cmp=$({type:t,selectors:[["app-soe"]],standalone:!0,features:[J],decls:34,vars:12,consts:[["loadedContent",""],[3,"title","activeTitle","title1"],[3,"jobNo"],[1,"grid","grid-cols-12","gap-x-6"],[1,"xl:col-span-12","col-span-12"],[1,"box"],[1,"box-header","justify-between","sm:flex","block"],[1,"box-title"],[1,"p-5"],[1,"table-responsive","mb-[0rem]"],[1,"md:col-span-12","col-span-12","mb-0"],[1,"md:col-span-6","col-span-12","mb-4"],["for","servicetype",1,"form-label"],[1,"flex","items-center","space-x-2"],[1,"text-danger"],["id","qualityAnalysisPdf",1,"table-responsive","m-2","!mt-0","!mb-[0rem]"],[1,"table","!p-0","!pt-4","!text-center","min-w-full"],[1,""],[1,"table-primary","border-b","border-defaultborder"],["scope","col ",1,"!text-center","w-[20%]"],["scope","col",1,"!text-center","w-[80%]"],[4,"ngIf","ngIfElse"],["id","servicetype",1,"form-select","!py-[0.59rem]","flex-grow",3,"ngModelChange","ngModel"],[3,"value",4,"ngFor","ngForOf"],["type","button",1,"ti-btn","ti-btn-primary-full","label-ti-btn","label-end","m-0","!py-1"],[3,"value"],["type","button",1,"ti-btn","ti-btn-primary-full","label-ti-btn","label-end","m-0","!py-1",3,"click"],[1,"ri-arrow-right-s-line","label-ti-btn-icon","ms-2","text-[1.125rem]"],["type","button",1,"ti-btn","ti-btn-primary-full","ti-btn-loader","ti-btn-disabled","m-0","!py-1"],[1,"me-2"],[1,"loading"],[1,"ri-refresh-line","text-[1rem]","animate-spin"],["role","status",1,"ti-spinner","text-primary","p-2","m-2"],[1,"sr-only"],[1,"border-b","border-defaultborder"],[1,"!p-1","!text-center"]],template:function(n,s){if(n&1&&(v(0,"app-page-header",1)(1,"app-job-data",2),r(2,"div",3)(3,"div",4)(4,"div",5)(5,"div",6)(6,"div",7),l(7," Run Information "),o(),v(8,"div"),o(),r(9,"div",8)(10,"div",9)(11,"div",10)(12,"div")(13,"div",11)(14,"label",12),l(15,"Select an Event"),o(),r(16,"div",13),p(17,he,5,5),m(18,"async"),p(19,_e,3,0),o(),p(20,xe,2,0,"div",14)(21,Ce,1,0),o(),r(22,"div",15)(23,"table",16)(24,"thead",17)(25,"tr",18)(26,"th",19),l(27,"Time"),o(),r(28,"th",20),l(29,"Event"),o()()(),p(30,Te,4,3,"tbody",21),m(31,"async"),p(32,Ie,3,0,"ng-template",null,0,q),o()()()()()()()()()),n&2){let g=R(33);b("title","SOE")("activeTitle","Start Job")("title1","Pre Survey"),d(),b("jobNo",s.id),d(16),E(17,f(18,8,s.data.EventLoading$)?19:17),d(3),E(20,s.SelectedEvent==0?20:21),d(10),b("ngIf",f(31,10,s.data.Soe$))("ngIfElse",g)}},dependencies:[X,z,K,Q,U,se,le,pe,ae,ne,oe,ie,ee,re,te,de]});let e=t;return e})();export{Ge as SoeComponent};
